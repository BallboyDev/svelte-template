## sveltekit 서버 구성

- +server.ts 파일은 커스텀 API 엔드포인트를 만드는데 사용된다. 서버에서만 작동하며 HTTP 요청을 직접 처리하고 응답을 반환하는 서버 사이드 로직을 작성한다.
- +page.server.ts 가 특정 페이지를 위한 데이터를 준비한다면, +server.ts는 페이지와 독립적인 재사용 가능한 API 라우트를 생성한다.
- +server.ts 파일안에 GET, POST, PUT 등 HTTP 메소드 이름으로 함수를 export 하면, 해당 메소드의 요청을 처리하는 핸들러가 되며 fallback 핸들러를 작성하면 이전에 작성되지 않은 나머지 메소드들의 요청을 처리한다.
- +server.ts 파일의 위치 역시 API URL 경로가 되는 파일 기반 라우팅을 지원한다.
    - src/routes/api/posts/+server.ts => /api/posts
    - src/routes/api/posts/[id]/+server.ts => /api/posts/[id]


### 경로 충돌
- +server.ts 파일은 +page 파일과 동일한 경로데 배치 될 수 있으며, 이를 통해 동일한 경로가 페이지 로드 또는 API 엔드 포인트가 될 수 있다. sveltekit은 경로의 충돌을 방지하기 위해 다음과 같은 규칙으로 경로 선택을 한다.
    1. PUT, PATCH, DELETE, OPTIONS 요청은 페이지 로딩에 적용되지 않으므로 +server.ts 경로가 선택된다.
    1. 요청의 타입이 text/html일 경우(브라우저 페이지 요청)는 페이지 로드 요청이 선택되고, 그 외에는 +server.ts 경로가 선택된다.
    1. GET 요청에 대한 응답에는 브라우저가 HTML/JSON을 선택할 수 있도록 Vary: Accept 헤더가 포함된다.